<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SPL Portfolio Progress Report – Week 7</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:#F0F2F5;color:#1B2A4A;line-height:1.5}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:#E8ECF1}::-webkit-scrollbar-thumb{background:#B0B8C4;border-radius:3px}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.anim{animation:fadeUp .5s ease both}
.d1{animation-delay:.05s}.d2{animation-delay:.1s}.d3{animation-delay:.15s}.d4{animation-delay:.2s}.d5{animation-delay:.25s}.d6{animation-delay:.3s}

.header{background:linear-gradient(135deg,#1B2A4A 0%,#1F4E79 50%,#2F5496 100%);padding:24px 32px;color:#fff}
.header-inner{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;max-width:1400px;margin:0 auto}
.header-label{font-size:11px;letter-spacing:2px;text-transform:uppercase;opacity:.7;font-weight:600}
.header h1{margin:4px 0 0;font-size:22px;font-weight:700;letter-spacing:-.3px;font-family:'Playfair Display',Georgia,serif}
.header-right{text-align:right}
.header-week{font-size:13px;font-weight:600;opacity:.9}
.header-sub{font-size:11px;opacity:.6;margin-top:2px}

.content{padding:24px 32px;max-width:1400px;margin:0 auto}

.kpi-row{display:flex;gap:16px;margin-bottom:24px;flex-wrap:wrap}
.kpi-card{background:#fff;border-radius:12px;padding:20px 24px;flex:1;min-width:150px;box-shadow:0 1px 3px rgba(0,0,0,.06);border:1px solid #E0E5EC;position:relative;overflow:hidden}
.kpi-bar{position:absolute;top:0;left:0;right:0;height:3px}
.kpi-inner{display:flex;align-items:center;gap:14px}
.kpi-icon{width:44px;height:44px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px}
.kpi-val{font-size:28px;font-weight:700;color:#1B2A4A;line-height:1.1;font-family:'Playfair Display',Georgia,serif}
.kpi-label{font-size:12px;color:#5A6A7E;font-weight:500;margin-top:2px}

.grid4{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-bottom:24px}
.card{background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 3px rgba(0,0,0,.06);border:1px solid #E0E5EC}
.card-title{font-size:12px;font-weight:600;color:#5A6A7E;margin-bottom:12px;text-transform:uppercase;letter-spacing:1px}

.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:24px}
@media(max-width:768px){.grid2{grid-template-columns:1fr}.kpi-row{flex-direction:column}}
.chart-title{font-size:14px;font-weight:700;color:#1B2A4A;margin-bottom:16px}

.progress-row{margin-bottom:12px}
.progress-labels{display:flex;justify-content:space-between;font-size:12px;margin-bottom:4px}
.progress-track{background:#E8ECF1;border-radius:6px;height:8px;overflow:hidden}
.progress-fill{height:100%;border-radius:6px;transition:width 1s ease}

.vert-row{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.vert-num{width:32px;height:32px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700}
.vert-bar-track{background:#E8ECF1;border-radius:4px;height:4px;margin-top:3px}
.vert-bar-fill{height:100%;border-radius:4px}

.legend-row{display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:8px}
.legend-item{display:flex;align-items:center;gap:4px;font-size:11px}
.legend-dot{width:8px;height:8px;border-radius:50%;display:inline-block}

.table-wrap{background:#fff;border-radius:12px;padding:24px;box-shadow:0 1px 3px rgba(0,0,0,.06);border:1px solid #E0E5EC}
.table-header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px;margin-bottom:16px}
.table-header h3{font-size:14px;font-weight:700}
.filter-bar{display:flex;gap:8px;flex-wrap:wrap}
.filter-btn{padding:6px 14px;border-radius:20px;border:none;cursor:pointer;font-size:12px;font-weight:600;transition:all .2s;background:#EEF1F6;color:#5A6A7E;font-family:'DM Sans',sans-serif}
.filter-btn.active{background:#1B2A4A;color:#fff}
.filter-btn:hover{opacity:.85}
.filter-select{padding:6px 12px;border-radius:20px;border:1px solid #E0E5EC;font-size:12px;font-weight:600;background:#fff;color:#1B2A4A;cursor:pointer;font-family:'DM Sans',sans-serif}

.data-table{width:100%;border-collapse:separate;border-spacing:0;font-size:12px}
.data-table th{text-align:left;padding:10px 12px;border-bottom:2px solid #1B2A4A;color:#1B2A4A;font-weight:700;font-size:11px;text-transform:uppercase;letter-spacing:.5px;white-space:nowrap}
.data-table td{padding:10px 12px}
.data-table tbody tr:nth-child(even){background:#FAFBFD}
.data-table tbody tr:hover td{background:rgba(214,227,248,.25)}
.risk-note{font-size:10px;color:#C62828;margin-top:2px;font-weight:400}

.badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;white-space:nowrap}
.badge-status{display:inline-flex;align-items:center;gap:4px}
.vert-badge{padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600}
.table-count{margin-top:12px;font-size:11px;color:#5A6A7E;text-align:right}
.no-data{padding:40px;text-align:center;color:#5A6A7E;font-size:13px}

.footer{margin-top:24px;padding:16px 0;border-top:1px solid #E0E5EC;display:flex;justify-content:space-between;font-size:11px;color:#5A6A7E}

svg text{font-family:'DM Sans',sans-serif}
</style>
</head>
<body>

<div class="header">
  <div class="header-inner">
    <div>
      <div class="header-label">SPL Portfolio</div>
      <h1>Progress Report Dashboard</h1>
    </div>
    <div class="header-right">
      <div class="header-week">Week 7 | Feb 15 – 19, 2026</div>
      <div class="header-sub">Prepared for SPL Management</div>
    </div>
  </div>
</div>

<div class="content">
  <div class="kpi-row" id="kpiRow"></div>
  <div class="grid4 anim d5" id="indicatorsRow"></div>
  <div class="grid2 anim d6" id="chartsRow"></div>
  <div class="table-wrap" id="tableSection"></div>
  <div class="footer">
    <span>Report Date: February 15, 2026</span>
    <span>SPL Portfolio Management</span>
  </div>
</div>

<script>
var projects=[
{id:1,name:"Develop request medication platform",vertical:"DOM",sub:"Medical Mail",type:"Roadmap",stage:"Upcoming",lastStage:"Upcoming",status:"On Track",requester:"Gada AlHussain",completion:"Mar 2026"},
{id:2,name:"ETOE: Offer service from Netherlands",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"Technical Discussions",lastStage:"Technical Discussions",status:"At Risk",requester:"Abdulmuhsin AlAjmi",completion:"Feb 28"},
{id:3,name:"ETOE: Offer service from UK",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"Technical Discussions",lastStage:"Technical Discussions",status:"At Risk",requester:"Abdulmuhsin AlAjmi",completion:"Feb 28"},
{id:4,name:"Reverse Logistics: Pickup Vs No Pickup",vertical:"DOM",sub:"Reverse Logistics",type:"Roadmap",stage:"Upcoming",lastStage:null,status:"On Track",requester:"Abrar A. AlZahrani",completion:"Feb 28"},
{id:5,name:"Protection Plus",vertical:"INT",sub:"",type:"Roadmap",stage:"Technical Discussions",lastStage:"Requirements Writing",status:"At Risk",requester:"Talal Binammar",completion:"Feb 28",risk:"Delayed - lack of SA resource"},
{id:6,name:"Updating Price Calculator",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"Technical Discussions",lastStage:"Technical Discussions",status:"On Track",requester:"",completion:"Feb 28"},
{id:7,name:"eCommerce NDR | Enhancing Events Sequence",vertical:"DOM",sub:"eCommerce",type:"Roadmap",stage:"Requirements Writing",lastStage:"Requirements Writing",status:"On Track",requester:"Fahad AlHadyan",completion:""},
{id:8,name:"Delivery Plus",vertical:"DOM",sub:"",type:"Roadmap",stage:"Requirements Writing",lastStage:null,status:"On Track",requester:"",completion:"Feb 28"},
{id:9,name:"Odd-sized Volumetric Weight charges on POS",vertical:"DOM",sub:"",type:"Roadmap",stage:"Upcoming",lastStage:null,status:"On Track",requester:"Mohammad Alloush",completion:"Mar 31"},
{id:10,name:"Redirection Revamping customer journey",vertical:"DOM",sub:"",type:"Roadmap",stage:"Testing",lastStage:"Development",status:"Off Track",requester:"",completion:"Feb 28"},
{id:11,name:"Post Business: Unified reviews management",vertical:"VAS",sub:"Post Business",type:"Roadmap",stage:"Development",lastStage:"Development",status:"Off Track",requester:"Mohammed AlSultan",completion:"Jan"},
{id:12,name:"Product Catalog",vertical:"CP",sub:"",type:"Roadmap",stage:null,lastStage:null,status:null,requester:"Abdulaziz AlRasheed",completion:"Jan"},
{id:13,name:"Unified Sales Lifecycle and Naqal Migration",vertical:"CP",sub:"",type:"Roadmap",stage:"Development",lastStage:null,status:null,requester:"Abdulaziz AlRasheed",completion:"Feb 28"},
{id:14,name:"Introduce new products (CRM)",vertical:"CP",sub:"",type:"Roadmap",stage:"Technical Discussions",lastStage:null,status:"At Risk",requester:"Abdulaziz AlRasheed",completion:"Feb 28"},
{id:15,name:"ASR: Unify communication under SPL branding",vertical:"INT",sub:"",type:"Roadmap",stage:"Cancelled",lastStage:null,status:null,requester:"",completion:"Feb 28"},
{id:16,name:"NDR: Operational gap closure and RPC training",vertical:"INT",sub:"",type:"Roadmap",stage:"Cancelled",lastStage:null,status:null,requester:"",completion:"Mar 31"},
{id:17,name:"Intl Inbound EBU: Automate CCPR issuance",vertical:"INT",sub:"Inbound",type:"Roadmap",stage:null,lastStage:null,status:null,requester:"Abdulaziz AlRasheed",completion:"Mar 31"},
{id:18,name:"Intl Inbound EBU: Integrate Fasah data",vertical:"INT",sub:"Inbound",type:"Roadmap",stage:null,lastStage:null,status:null,requester:"Abdulaziz AlRasheed",completion:"Feb 28"},
{id:19,name:"Intl Inbound EBU: Trigger DDU SMS",vertical:"INT",sub:"Inbound",type:"Roadmap",stage:null,lastStage:null,status:null,requester:"Abdulaziz AlRasheed",completion:"Feb 28"},
{id:20,name:"ETOE: Offer Service from US",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"On-Hold",lastStage:null,status:null,requester:"Abdulmuhsin AlAjmi",completion:"Feb 28"},
{id:21,name:"Improving tracking",vertical:"INT",sub:"Inbound - Alami",type:"Roadmap",stage:"Technical Discussions",lastStage:"Requirements Writing",status:null,requester:"",completion:"Mar"},
{id:22,name:"Migration to EBU system",vertical:"INT",sub:"Inbound - Alami",type:"Roadmap",stage:"Requirements Writing",lastStage:null,status:null,requester:"",completion:"Mar"},
{id:23,name:"Sea Freight Re-launch",vertical:"INT",sub:"Outbound - Sea Freight",type:"Roadmap",stage:"Upcoming",lastStage:null,status:"On Track",requester:"",completion:"Mar"},
{id:24,name:"Automate declaration value document in POS",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"Technical Discussions",lastStage:"Technical Discussions",status:"On Track",requester:"",completion:"Mar"},
{id:25,name:"Re-price Intl Outbound Rate Structure",vertical:"INT",sub:"Outbound",type:"Roadmap",stage:"Launched",lastStage:null,status:null,requester:"",completion:"Feb 28"},
{id:26,name:"Enabling SADAD Payments for SMEs",vertical:"DOM",sub:"SME",type:"Ad-hoc",stage:"On-Hold",lastStage:"Technical Discussions",status:"Off Track",requester:"Mohammad Alloush",completion:""},
{id:27,name:"New Weight Brackets and Pricing Update",vertical:"INT",sub:"",type:"Ad-hoc",stage:"Launched",lastStage:"Testing",status:"On Track",requester:"",completion:"Jan"},
{id:28,name:"Display Name",vertical:"DOM",sub:"Reverse Logistics",type:"Ad-hoc",stage:"Testing",lastStage:"Testing",status:"Off Track",requester:"",completion:"",risk:"Pending from Naqel Side"},
{id:29,name:"Activate Pakistan sea freight service",vertical:"INT",sub:"Outbound - Sea Freight",type:"BAU",stage:"Launched",lastStage:"Testing",status:"On Track",requester:"Yazan AlNowaisir",completion:"Jan"},
{id:30,name:"Remove SMEs Descriptive Address",vertical:"DOM",sub:"SME",type:"BAU",stage:"Launched",lastStage:"Technical Discussions",status:"On Track",requester:"Mohammed AlSultan",completion:"Feb 28"},
{id:31,name:"Adding/Displaying SPL Payslip on Credit Sales",vertical:"DOM",sub:"eCommerce",type:"BAU",stage:"Launched",lastStage:null,status:null,requester:"",completion:"Jan"},
{id:32,name:"Activate chatbot and SMS for NGH",vertical:"DOM",sub:"Medical Mail",type:"BAU",stage:"Launched",lastStage:"Upcoming",status:"On Track",requester:"Gada AlHussain",completion:"Feb 12"}
];

var stageColors={"Upcoming":"#90CAF9","Requirements Writing":"#CE93D8","Technical Discussions":"#FFB74D","Development":"#4FC3F7","Testing":"#AED581","Launched":"#66BB6A","On-Hold":"#BDBDBD","Cancelled":"#EF5350"};
var statusCfg={"On Track":{bg:"#E8F5E9",color:"#2E7D32",icon:"\u2713"},"At Risk":{bg:"#FFF8E1",color:"#F9A825",icon:"\u26A0"},"Off Track":{bg:"#FFEBEE",color:"#C62828",icon:"\u2717"}};
var vertCfg={INT:{bg:"#FFF3E0",color:"#EF6C00"},DOM:{bg:"#F3E5F5",color:"#6A1B9A"},VAS:{bg:"#E0F2F1",color:"#00695C"},CP:{bg:"#D6E3F8",color:"#4A90D9"}};

var activeFilter="all";
var selectedVertical="all";

function renderKPIs(){
  var kpis=[
    {icon:"\uD83D\uDCC1",value:32,label:"Total Q1 CRs",color:"#2F5496",bg:"#D6E3F8"},
    {icon:"\u26A1",value:14,label:"Active CRs",color:"#4A90D9",bg:"#E3F2FD"},
    {icon:"\uD83D\uDCC8",value:4,label:"Upcoming",color:"#2E7D32",bg:"#E8F5E9"},
    {icon:"\uD83D\uDE80",value:6,label:"Launched",color:"#00897B",bg:"#E0F2F1"}
  ];
  var html="";
  for(var i=0;i<kpis.length;i++){
    var k=kpis[i];
    html+='<div class="kpi-card anim d'+(i+1)+'">'
      +'<div class="kpi-bar" style="background:'+k.color+'"></div>'
      +'<div class="kpi-inner">'
      +'<div class="kpi-icon" style="background:'+k.bg+'">'+k.icon+'</div>'
      +'<div><div class="kpi-val">'+k.value+'</div><div class="kpi-label">'+k.label+'</div></div>'
      +'</div></div>';
  }
  document.getElementById("kpiRow").innerHTML=html;
}

function renderIndicators(){
  var el=document.getElementById("indicatorsRow");
  var dpiSvg='<svg viewBox="0 0 120 70" width="120" height="70">'
    +'<path d="M10 65 A50 50 0 0 1 110 65" fill="none" stroke="#E0E5EC" stroke-width="10" stroke-linecap="round"/>'
    +'<path d="M10 65 A50 50 0 0 1 110 65" fill="none" stroke="#C62828" stroke-width="10" stroke-linecap="round" stroke-dasharray="105 157"/>'
    +'</svg>';

  var total=20;var r=40;var cx=55;var cy=55;
  var circumference=2*Math.PI*r;
  var slices=[{v:12,c:"#2E7D32"},{v:4,c:"#F9A825"},{v:4,c:"#C62828"}];
  var offset=0;
  var donutPaths="";
  for(var i=0;i<slices.length;i++){
    var s=slices[i];
    var len=(s.v/total)*circumference;
    donutPaths+='<circle cx="'+cx+'" cy="'+cy+'" r="'+r+'" fill="none" stroke="'+s.c+'" stroke-width="14" stroke-dasharray="'+len+' '+(circumference-len)+'" stroke-dashoffset="'+(-offset)+'" transform="rotate(-90 '+cx+' '+cy+')"/>';
    offset+=len;
  }

  var verticals=[
    {name:"International",value:10,color:"#EF6C00"},
    {name:"Domestic",value:11,color:"#6A1B9A"},
    {name:"VAS",value:1,color:"#00695C"},
    {name:"CP",value:3,color:"#4A90D9"}
  ];
  var vertHtml="";
  for(var i=0;i<verticals.length;i++){
    var v=verticals[i];
    vertHtml+='<div class="vert-row">'
      +'<div class="vert-num" style="background:'+v.color+'18;color:'+v.color+'">'+v.value+'</div>'
      +'<div style="flex:1"><div style="font-size:12px;font-weight:600">'+v.name+'</div>'
      +'<div class="vert-bar-track"><div class="vert-bar-fill" style="width:'+(v.value/32*100)+'%;background:'+v.color+'"></div></div>'
      +'</div></div>';
  }

  el.innerHTML=''
    +'<div class="card" style="display:flex;flex-direction:column;align-items:center">'
    +'<div class="card-title">Delivery Performance Index</div>'
    +'<div style="position:relative;width:120px;height:80px">'+dpiSvg
    +'<div style="position:absolute;bottom:0;left:50%;transform:translateX(-50%);font-size:22px;font-weight:700;color:#C62828;font-family:Playfair Display,Georgia,serif">67%</div></div>'
    +'<div style="margin-top:8px;font-size:11px;color:#C62828;font-weight:600;background:#FFEBEE;padding:2px 10px;border-radius:12px">Below Target</div></div>'

    +'<div class="card"><div class="card-title">Progress (End of Feb)</div>'
    +'<div class="progress-row"><div class="progress-labels"><span style="font-weight:500">Planned</span><span style="font-weight:700;color:#2F5496">23%</span></div>'
    +'<div class="progress-track"><div class="progress-fill" style="width:23%;background:#2F5496"></div></div></div>'
    +'<div class="progress-row"><div class="progress-labels"><span style="font-weight:500">Actual</span><span style="font-weight:700;color:#C62828">15%</span></div>'
    +'<div class="progress-track"><div class="progress-fill" style="width:15%;background:#C62828"></div></div></div></div>'

    +'<div class="card" style="display:flex;flex-direction:column;align-items:center">'
    +'<div class="card-title">Status Distribution</div>'
    +'<svg viewBox="0 0 110 110" width="130" height="130">'
    +'<circle cx="'+cx+'" cy="'+cy+'" r="'+r+'" fill="none" stroke="#E8ECF1" stroke-width="14"/>'+donutPaths+'</svg>'
    +'<div class="legend-row">'
    +'<div class="legend-item"><span class="legend-dot" style="background:#2E7D32"></span><b>12</b>&nbsp;On Track</div>'
    +'<div class="legend-item"><span class="legend-dot" style="background:#F9A825"></span><b>4</b>&nbsp;At Risk</div>'
    +'<div class="legend-item"><span class="legend-dot" style="background:#C62828"></span><b>4</b>&nbsp;Off Track</div>'
    +'</div></div>'

    +'<div class="card"><div class="card-title">By Vertical</div>'+vertHtml+'</div>';
}

function renderCharts(){
  var el=document.getElementById("chartsRow");
  var stages=[
    {name:"Upcoming",count:4,color:"#90CAF9"},
    {name:"Req. Writing",count:3,color:"#CE93D8"},
    {name:"Tech Disc.",count:7,color:"#FFB74D"},
    {name:"Development",count:2,color:"#4FC3F7"},
    {name:"Testing",count:3,color:"#AED581"},
    {name:"Launched",count:6,color:"#66BB6A"},
    {name:"On-Hold",count:2,color:"#BDBDBD"},
    {name:"Cancelled",count:2,color:"#EF5350"}
  ];
  var maxVal=8;var barW=50;var barGap=14;var chartH=190;
  var chartW=stages.length*(barW+barGap)+50;
  var bars="";var gridLines="";
  var gridVals=[0,2,4,6,8];
  for(var g=0;g<gridVals.length;g++){
    var gy=chartH-35-(gridVals[g]/maxVal)*140;
    gridLines+='<line x1="35" y1="'+gy+'" x2="'+chartW+'" y2="'+gy+'" stroke="#E8ECF1" stroke-width="0.5"/>';
    gridLines+='<text x="28" y="'+(gy+4)+'" text-anchor="end" font-size="9" fill="#5A6A7E">'+gridVals[g]+'</text>';
  }
  for(var i=0;i<stages.length;i++){
    var s=stages[i];
    var bh=(s.count/maxVal)*140;
    var x=45+i*(barW+barGap);
    var y=chartH-35-bh;
    bars+='<rect x="'+x+'" y="'+y+'" width="'+barW+'" height="'+bh+'" rx="4" fill="'+s.color+'"/>';
    bars+='<text x="'+(x+barW/2)+'" y="'+(y-6)+'" text-anchor="middle" font-size="11" font-weight="600" fill="#1B2A4A">'+s.count+'</text>';
    bars+='<text x="'+(x+barW/2)+'" y="'+(chartH-12)+'" text-anchor="middle" font-size="9" fill="#5A6A7E">'+s.name+'</text>';
  }

  var types=[{name:"Roadmap",count:25,color:"#2F5496"},{name:"Ad-hoc",count:3,color:"#EF6C00"},{name:"BAU",count:4,color:"#00695C"}];
  var pieTotal=32;var pieR=65;var pieCx=90;var pieCy=90;
  var pieOffset=0;var pieSlices="";
  for(var i=0;i<types.length;i++){
    var t=types[i];
    var pct=t.count/pieTotal;
    var angle=pct*360;
    var startAngle=pieOffset;
    var endAngle=pieOffset+angle;
    pieOffset+=angle;
    var s1=startAngle*Math.PI/180;var s2=endAngle*Math.PI/180;
    var x1=pieCx+pieR*Math.cos(s1);var y1=pieCy+pieR*Math.sin(s1);
    var x2=pieCx+pieR*Math.cos(s2);var y2=pieCy+pieR*Math.sin(s2);
    var large=angle>180?1:0;
    var midA=(startAngle+endAngle)/2*Math.PI/180;
    var lx=pieCx+(pieR+20)*Math.cos(midA);var ly=pieCy+(pieR+20)*Math.sin(midA);
    pieSlices+='<path d="M'+pieCx+','+pieCy+' L'+x1+','+y1+' A'+pieR+','+pieR+' 0 '+large+' 1 '+x2+','+y2+' Z" fill="'+t.color+'"/>';
    pieSlices+='<text x="'+lx+'" y="'+ly+'" text-anchor="middle" font-size="10" font-weight="600" fill="#1B2A4A">'+t.name+'</text>';
  }

  var legendHtml="";
  for(var i=0;i<types.length;i++){
    legendHtml+='<div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">'
      +'<div style="width:14px;height:14px;border-radius:3px;background:'+types[i].color+'"></div>'
      +'<span style="font-size:12px;font-weight:600">'+types[i].name+'</span>'
      +'<span style="font-size:12px;color:#5A6A7E">('+types[i].count+')</span></div>';
  }

  el.innerHTML=''
    +'<div class="card"><div class="chart-title">Stage Pipeline</div>'
    +'<div style="overflow-x:auto"><svg viewBox="0 0 '+chartW+' '+chartH+'" width="100%" height="210" preserveAspectRatio="xMidYMid meet">'+gridLines+bars+'</svg></div></div>'
    +'<div class="card"><div class="chart-title">CR Type Breakdown</div>'
    +'<div style="display:flex;align-items:center;gap:24px;flex-wrap:wrap;justify-content:center">'
    +'<svg viewBox="0 0 180 180" width="160" height="160" style="transform:rotate(-90deg)">'+pieSlices+'</svg>'
    +'<div>'+legendHtml+'</div></div></div>';
}

function makeStageBadge(stage){
  if(!stage) return '<span style="color:#999;font-size:11px">\u2014</span>';
  var c=stageColors[stage]||"#BDBDBD";
  return '<span class="badge" style="background:'+c+'33;color:'+c+';border:1px solid '+c+'66">'+stage+'</span>';
}
function makeStatusBadge(status){
  if(!status) return '<span style="color:#999;font-size:11px">\u2014</span>';
  var s=statusCfg[status]||{bg:"#eee",color:"#666",icon:"?"};
  return '<span class="badge badge-status" style="background:'+s.bg+';color:'+s.color+'">'+s.icon+' '+status+'</span>';
}
function makeVertBadge(p){
  var vc=vertCfg[p.vertical]||{bg:"#eee",color:"#666"};
  return '<span class="vert-badge" style="background:'+vc.bg+';color:'+vc.color+'">'+p.vertical+(p.sub?' - '+p.sub:'')+'</span>';
}

function renderTable(){
  var filtered=[];
  for(var i=0;i<projects.length;i++){
    var p=projects[i];
    var passFilter=true;
    if(activeFilter==="active") passFilter=p.stage&&["Launched","Cancelled","On-Hold"].indexOf(p.stage)===-1;
    else if(activeFilter==="launched") passFilter=p.stage==="Launched";
    else if(activeFilter==="onhold") passFilter=p.stage==="On-Hold"||p.stage==="Cancelled";
    if(passFilter&&selectedVertical!=="all") passFilter=p.vertical===selectedVertical;
    if(passFilter) filtered.push(p);
  }

  var filterLabels={all:"All CRs",active:"Active",launched:"Launched",onhold:"On-Hold / Cancelled"};
  var filterKeys=["all","active","launched","onhold"];
  var filtersHtml="";
  for(var i=0;i<filterKeys.length;i++){
    var f=filterKeys[i];
    filtersHtml+='<button class="filter-btn'+(activeFilter===f?' active':'')+'" onclick="setFilter(\''+f+'\')">'
      +filterLabels[f]+'</button>';
  }

  var vertOptions=["all","INT","DOM","VAS","CP"];
  var selectHtml='<select class="filter-select" onchange="setVertical(this.value)">';
  for(var i=0;i<vertOptions.length;i++){
    var v=vertOptions[i];
    selectHtml+='<option value="'+v+'"'+(selectedVertical===v?' selected':'')+'>'+(v==="all"?"All Verticals":v)+'</option>';
  }
  selectHtml+='</select>';

  var rowsHtml="";
  if(filtered.length===0){
    rowsHtml='<tr><td colspan="9" class="no-data">No CRs match the selected filters.</td></tr>';
  }else{
    for(var i=0;i<filtered.length;i++){
      var p=filtered[i];
      rowsHtml+='<tr>'
        +'<td style="font-weight:600;color:#5A6A7E">'+p.id+'</td>'
        +'<td style="font-weight:600;max-width:260px">'+p.name+(p.risk?'<div class="risk-note">'+p.risk+'</div>':'')+'</td>'
        +'<td style="white-space:nowrap">'+makeVertBadge(p)+'</td>'
        +'<td style="font-size:11px;color:#5A6A7E">'+p.type+'</td>'
        +'<td>'+makeStageBadge(p.stage)+'</td>'
        +'<td>'+makeStageBadge(p.lastStage)+'</td>'
        +'<td>'+makeStatusBadge(p.status)+'</td>'
        +'<td style="font-size:11px;color:#5A6A7E">'+(p.requester||'\u2014')+'</td>'
        +'<td style="font-size:11px;font-weight:500;white-space:nowrap">'+(p.completion||'\u2014')+'</td>'
        +'</tr>';
    }
  }

  document.getElementById("tableSection").innerHTML=''
    +'<div class="table-header"><h3>CR Detail View</h3>'
    +'<div class="filter-bar">'+filtersHtml+selectHtml+'</div></div>'
    +'<div style="overflow-x:auto"><table class="data-table"><thead><tr>'
    +'<th>#</th><th>CR Name</th><th>Vertical</th><th>Type</th><th>Current Stage</th><th>Last Week</th><th>Status</th><th>Requester</th><th>Completion</th>'
    +'</tr></thead><tbody>'+rowsHtml+'</tbody></table></div>'
    +'<div class="table-count">Showing '+filtered.length+' of '+projects.length+' CRs</div>';
}

function setFilter(f){activeFilter=f;renderTable();}
function setVertical(v){selectedVertical=v;renderTable();}

renderKPIs();
renderIndicators();
renderCharts();
renderTable();
</script>
</body>
</html>
